Dynamic steady-state analysis addresses the shortcomings of static steady-state
analysis in one particular but important context. It tackles the scenario where
the power consumption follows a periodic pattern. In this case, after a
sufficiently long time, the system will not reach a static steady state but
instead a dynamic steady state: temperature will starts to exhibit a periodic
patter following the periodic patter of power. Then the goal of the analysis is
to find the periodic temperature profile \mq, called the dynamic steady-state
temperature profile, that corresponds to a given periodic power profile \mp.

In the case of applications that exhibit periodic or close to periodic behavior,
this analysis is of particular importance. Any design optimization has to be
performed such that the efficiency and reliability of the system at hand are
maximized considering not a relatively short transient time interval at the
system's start but the context in which the system is to function over a long
period of time, which is exactly the dynamic steady state of the system at hand.

A prominent example of a design task for which the analysis is of central
importance is reliability optimization that addresses the thermal-cycling
fatigue. What is important in this context is that not only the average and
maximum temperature have a huge impact on the lifetime of the chip but also the
amplitude and frequency of temperature oscillations. Thus, efficient reliability
optimization depends on the availability of the actual dynamic steady-state
temperature profile, which we discuss further in
\sref{reliability-optimization}.

\subsection{Prior Work}
\slab{dynamic-steady-state-prior}

Let us elaborate on the techniques that have been applied in the literature in
order to calculate the dynamic steady-state temperature profile.

A straightforward approximation of the profile can be obtained by running a
temperature simulator over one or more successive periods of the application
until it is assumed that a sufficiently accurate approximation of the dynamic
steady state has been attained \cite{srinivasan2004}. The typical simulator of
choice is HotSpot \cite{skadron2003}, which is the state-of-the-art for
system-level temperature analysis \cite{srinivasan2004, liao2005, coskun2006,
liu2007, huang2009b, xiang2010, thiele2011}. The simulator performs transient
temperature analysis by solving \eref{temperature-model-original} numerically
via the Runge--Kutta fourth-order method \cite{press2007}.

\inputfigure{dynamic-steady-state-prior}
The number of iterations required to reach the dynamic steady state depends on
the thermal characteristics of the platform. In order to illustrate this aspect,
consider an application with a period of 500~ms running on five hypothetical
platforms with processing-element areas of 1--25~mm\textsuperscript{2}. Let us
simulate 50 successive periods of the application via HotSpot with its default
settings and compare the resulting approximations in each period with the actual
temperature profile using the \ac{NRMSE}. The comparison is shown in
\fref{transient-state-error}. It can be observed that the number of successive
periods over which transient analysis has to be performed in order to achieve a
satisfactory level of accuracy is significant for the majority of the
configurations, which entails large computation times. For instance, for an area
of 9~mm\textsuperscript{2}, even after 15 iterations, the \ac{NRMSE} is still
close to 20\%. Using the analytical approach to transient analysis presented in
\sref{transient-analysis}, the calculation can be sped up; however, the large
number of iterations still keeps the computation cost unreasonably high as we
shall discuss further in \sref{dynamic-steady-state-results}. Moreover, this
approximation technique provides no guarantees on the resulting accuracy since
there is no a reliable metric for measuring the proximity to the actual
solution, the actual dynamic steady-state temperature profile.

Another crude but fast approximation of the profile is proposed in
\cite{huang2009b}. It forgoes transient analysis all together and resides to
static steady-state analysis instead. To elaborate, it is assumed that, in each
time interval wherein the power consumption is constant, the system
instantaneously reaches a static steady state. The result of this procedure is a
stepwise temperature curve where each step corresponds to the steady-state
temperature that would be reached if the corresponding power was applied for a
sufficiently long time.

\inputfigure{static-steady-state-example}
An example of such an approximation along with the corresponding dynamic
steady-state temperature profile of an application with 10 tasks and a period of
100~ms is given in \fref{static-steady-state-example}. The processing-element
area is 25~mm\textsuperscript{2} in this case. The reduced accuracy of this
technique is due to the mismatch between the actual temperature within each
interval and the static steady-state temperature. The inaccuracy depends on the
thermal characteristics of the platform and on the application itself. In order
to illustrate this, let us simulate five applications with periods of
10--1000~ms running on five platforms with an area per processing element of
1--25~mm\textsuperscript{2}. The errors are shown in
\fref{static-steady-state-error}. It can be seen that, for example, for an area
of 10~mm\textsuperscript{2} and a period of 100~ms, the \ac{NRMSE} of this
approximation technique is close to 40\%.

To conclude, the state-of-the-art techniques for dynamic steady-state
temperature analysis are slow and inaccurate. This state of affairs makes them
difficult and dangerous to be utilized for the purpose of design optimization.

\subsection{Our Solution}
\slab{dynamic-steady-state-solution}

In this subsection, we are to formalize the problem of dynamic steady-state
temperature analysis and to develop an exact and, moreover, computationally
efficient solution to this problem, eliminating the issues of the
state-of-the-art solutions discussed in the previous subsection.

Consider the temperature model in \eref{temperature-model} and the corresponding
recurrence in \eref{transient-state-recurrence}. The key characteristic of a
dynamic steady state is as follows:
\begin{equation} \elab{dynamic-steady-state-condition}
  \vs_0 = \vs_\ns.
\end{equation}
In words, the above condition means that, once the dynamic steady state has been
reached, the system starts to arrive at its initial state at the end of each
iteration, which is what makes it periodic. Then, using
\eref{transient-state-recurrence}, the dynamic steady-state temperature profile
can be computed by solving the following system of linear equations:
\[
  \begin{cases}
    \vs_1 - \m{E} \vs_\ns & = \m{F} \vp_1 \\
    \dots \\
    \vs_\ns - \m{E} \vs_{\ns - 1} & = \m{F} \vp_\ns
  \end{cases}
\]
where the first equation enforces the boundary condition in
\eref{dynamic-steady-state-condition}. In order to get the big picture, the
system can be rewritten as follows:
\begin{equation} \elab{dynamic-steady-state-system}
  \resizebox{0.89\linewidth}{!}{
    $\underbrace{\left[
      \begin{array}{rrrrrrr}
        \m{I}  & \v{0}  & \v{0}  & \cdots & \v{0}  & \v{0}  & -\m{E} \\
        -\m{E} & \m{I}  & \v{0}  & \cdots & \v{0}  & \v{0}  & \v{0}  \\
        \v{0}  & -\m{E} & \m{I}  & \cdots & \v{0}  & \v{0}  & \v{0}  \\
        \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots \\
        \v{0}  & \v{0}  & \v{0}  & \cdots & \m{I}  & \v{0}  & \v{0}  \\
        \v{0}  & \v{0}  & \v{0}  & \cdots & -\m{E} & \m{I}  & \v{0}  \\
        \v{0}  & \v{0}  & \v{0}  & \cdots & \v{0}  & -\m{E} & \m{I}
      \end{array}
    \right]}_{\displaystyle \mathbb{A}} \underbrace{\left[
      \begin{array}{l}
        \vs_1         \\
        \vs_2         \\
        \vs_3         \\
        \cdots        \\
        \vs_{\ns - 2} \\
        \vs_{\ns - 1} \\
        \vs_\ns
      \end{array}
    \right]}_{\displaystyle \mathbb{X}} = \underbrace{\left[
      \begin{array}{l}
        \m{F} \vp_1         \\
        \m{F} \vp_2         \\
        \m{F} \vp_3         \\
        \cdots              \\
        \m{F} \vp_{\ns - 2} \\
        \m{F} \vp_{\ns - 1} \\
        \m{F} \vp_\ns
      \end{array}
    \right]}_{\displaystyle \mathbb{B}}$
  }
\end{equation}
where $\mathbb{A}$ is an $\nn \ns \times \nn \ns$ matrix, and $\mathbb{X}$ and
$\mathbb{B}$ are $\nn \ns$-element vectors.

The most direct way to solve the system in \eref{dynamic-steady-state-system} is
to use a dense solver such as the \up{LU} decomposition \cite{press2007}.
However, since $\mathbb{A}$ is a sparse matrix, a more appropriate approach is
to employ a sparse solver such as the unsymmetric multifrontal method
\cite{davis2004}. The computational complexity of such solutions is $\bigo{n_s^3
n_n^3}$ \cite{press2007} where $\nn$ is the number of nodes in the thermal
\up{RC} circuit, and $\ns$ is the number of samples in the power profile. The
problem here is that the system to solve can be extremely large, in particular
due to $\ns$. In such cases, direct solvers are prohibitively slow and require
an enormous amount of memory. Therefore, we do not discuss them any further.

Another potential approach is leveraging an iterative method for solving systems
of linear equations such as the Jacobi or Gauss--Seidel method \cite{press2007}.
Such methods are designed to overcome problems of direct solvers, and,
consequently, they are applicable for very large systems. However, the most
important issue with these methods is their convergence. In our experiments, we
have not observed any advantages of using these methods compared to the other
considered techniques. Thus, they are excluded from the discussion.

Yet another solution can be obtain by observing that $\mathbb{A}$ in
\eref{dynamic-steady-state-system} is, in fact, a block Toeplitz matrix and,
moreover, a block-circulant matrix, wherein each block row is rotated one block
element to the right relative to the preceding block row. This observation leads
to a wide range of possible techniques for solving the system in
\eref{dynamic-steady-state-system} such as the fast Fourier transform
\cite{mazancourt1983}, which we shall discuss further in our experiments in
given \sref{dynamic-steady-state-results}.

To summarize, the major problem with the aforementioned techniques is that
\one~the sparseness of $\mathbb{A}$ is not taken into account, or \two~its
specific structure is ignored, resulting in inefficient and, in some cases,
inaccurate computations. Let us now develop a solution that does not have these
issues.

Have a careful look at the structure of $\mathbb{A}$ in
\eref{dynamic-steady-state-system}. The nonzero elements are located only on the
block diagonal, on the subdiagonal attached to the block diagonal, and on the
superdiagonal in the top-right corner of the matrix. Linear systems with similar
structures arise in boundary value problems for ordinary differential equations,
and the typical technique to solve them is to form a so-called condensed
equation or condensed system \cite{stoer2002} as follows.

To begin with, let
\[
  \v{v}_i = \m{F} \vp_i
\]
for $i = \range{1}{\ns}$. Equation~\eref{transient-state-recurrence} can then be
rewritten as follows:
\begin{equation} \elab{dynamic-steady-state-recurrence}
  \vs_i = \m{E} \vs_{i - 1} + \v{v}_i
\end{equation}
for $i = \range{1}{\ns}$. Apply this formula recursively starting from $\vs_0$
leads to
\[
  \vs_i = \m{E}^i \vs_0 + \v{w}_i
\]
for $i = \range{1}{\ns}$. In the above, $\v{w}_i$ is an auxiliary recurrence
defined as
\begin{equation} \elab{dynamic-steady-state-auxiliary-recurrence}
  \v{w}_i = \m{E} \v{w}_{i - 1} + \v{v}_i
\end{equation}
for $i = \range{1}{\ns}$ where
\[
  \v{w}_0 = \v{0}.
\]
After taking \ns steps, we arrive at the following state vector:
\[
  \vs_\ns = \m{E}^\ns \vs_0 + \v{w}_\ns.
\]
Taking into account the boundary condition given in
\eref{dynamic-steady-state-condition}, we obtain the following system of linear
equations:
\[
  (\m{I} - \m{E}^\ns) \vs_\ns = \v{w}_\ns.
\]
Since $\m{E}$ is the matrix exponential, which it can be seen in
\eref{matrix-exponential}, the above system can be rewritten as follows:
\[
  (\m{I} - \m{U} e^{\m{\Lambda} \period} \transpose{\m{U}}) \vs_\ns = \v{w}_\ns
\]
where $\period = \ns \dt$ is the period of the power profile \mp. By splitting
the identity matrix $\m{I}$ into $\m{U} \transpose{\m{U}}$, we obtain the
following solution to the system:
\begin{align}
  \vs_\ns
  & = \m{U} (\m{I} - e^{\m{\Lambda} \period})^{-1} \transpose{\m{U}} \v{w}_\ns \elab{t0} \\
  & = \m{U} \: \diagonal{\frac{1}{1 - e^{\lambda_1 \period}}}{\frac{1}{1 - e^{\lambda_\ns \period}}} \transpose{\m{U}} \v{w}_\ns. \nonumber
\end{align}
The above equation yields not only the final state vector $\vs_\ns$ but also the
initial one $\vs_0$. Consequently, the rest of the state vectors $\{ \vs_i \}_{i
= 1}^{\ns - 1}$ can be successively found by means of
\eref{dynamic-steady-state-recurrence} where each $\v{v}_i$ has already been
calculated when computing $\v{w}_\ns$. The last step of the solution is to
compute the actual dynamic steady-state temperature profile \mq by applying
\eref{temperature-algebraic}.

\inputalgorithm{dynamic-steady-state}
It can be seen that the solution to the $\nn \ns \times \nn \ns$ system given in
\eref{dynamic-steady-state-system} has been reduced to the two trivial
recurrences given in \eref{dynamic-steady-state-recurrence} and
\eref{dynamic-steady-state-auxiliary-recurrence} that traverse the \ns steps of
the power profile \mp. The pseudocode of a potential implementation of the
solution process is given in \aref{dynamic-steady-state}.

It is worth noting that the auxiliary transformation presented in
\sref{transient-state-solution} and the accompanying eigendecomposition in
\eref{eigendecomposition} have substantially simplified the calculations
associated with dynamic steady-state analysis. It should also be noted that the
eigendecomposition along with $\m{E}$ and $\m{F}$ are computed only once for a
particular thermal \up{RC} circuit and can be considered as given together with
the circuit. In other words, these quantities stay when different power profiles
are to be analyzed, which is particularly advantageous when an intensive
design-space-exploration procedure is concerned.

The computational complexity of the whole procedure is estimated to be
\[
  \bigo{\ns n_n^2 + n_n^3}.
\]
The complexity is linear with respect to \ns, which is important since \ns is
typically much large than \nn, that is, the number of thermal nodes.

\subsection{Experimental Results}
\slab{dynamic-steady-state-results}

Let us now investigate the scaling of the solution to dynamic steady-state
analysis proposed in \sref{dynamic-steady-state-solution}. All the experiments
are conducted on a \up{GNU}/Linux machine equipped with Intel Core i7
3.4~\up{GH}z and 8~\up{GB} of \up{RAM}.

The thermal \up{RC} circuits are considered by means of HotSpot
\cite{skadron2003} with its default configuration, and they follow the principle
described in \sref{temperature-model}. The sampling interval $\dt$ of power and
temperature profiles is set to 1~ms.

We consider two alternative techniques for comparison purposes, namely, the one
based on iterative transient analysis, which is mentioned in
\sref{dynamic-steady-state-prior}, and the one based on the fast Fourier
transform, which is mentioned in \sref{dynamic-steady-state-solution}, since
they are comparable with our technique in terms of accuracy. In the case of
transient analysis, we evaluate both the fast analytical solution described in
\sref{transient-state-solution} and the one implemented in HotSpot, and the
corresponding iterative calculation is undertaken until the \ac{NRMSE} relative
to the dynamic steady-state temperature profile calculated by means of the
proposed method (which is exact) is less than 1\%.

\inputfigure{dynamic-steady-state-scaling}
First, we vary the period \period of power and temperature profiles---and,
thereby, the number of samples \ns that they contain---while keeping the
architecture fixed, which is a quad-core platform with a processing-element area
of 4~mm\textsuperscript{2}. The results of this experiment are depicted in
\fref{scaling-steps} on a semi-logarithmic scale. It can be seen that the
proposed technique is 9--170 times faster than iterative transient analysis with
the analytical solution and roughly 5000 times faster than iterative transient
analysis with HotSpot.

In the second experiment, we evaluate the scaling of our method with respect to
the number of processing elements \np. The period is fixed to 500~ms, which
results in 500 time steps. The obtained results are shown in
\fref{scaling-elements}. It can be observed that the proposed technique provides
a significant performance improvement relative to the alternative solutions.
