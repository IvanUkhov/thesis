\begin{algorithm}[t]
  \caption{Calculation of a dynamic steady-state temperature profile.}
  \alab{dynamic-steady-state}
  \begin{algorithmic}[1]
    \vspace{0.4em}
    \Require{$\mp \in \real^{\np \times \ns}$}
    \Ensure{$\mq \in \real^{\np \times \ns}$}
    \vspace{0.5em}
    \Let{$\m{V}$}{$\m{F} \mp$} \Comment{an auxiliary variable}
    \Let{$\v{w}$}{$\m{V}(:, 1)$} \Comment{an auxiliary variable}
    \For{$i \gets 2 \textrm{ to } \ns$}
      \Let{$\v{w}$}{$\m{E} \v{w} + \m{V}(:, i)$}
    \EndFor
    \Let{$\m{S}(:, 1)$}{$\m{U} \; \diagonal{\frac{1}{1 - e^{\lambda_i \period}}} \transpose{\m{U}} \v{w}$} \Comment{a matrix version of $\vs$}
    \For{$i \gets 2 \textrm{ to } \ns$}
      \Let{$\m{S}(:, i)$}{$\m{E} \m{S}(:, i - 1) + \m{V}(:, i - 1)$}
    \EndFor
    \Let{$\mq$}{$\transpose{\m{B}} \m{S} + \mq_\ambient$} \Comment{a matrix version of $\vq_\ambient$}
    \vspace{0.4em}
  \end{algorithmic}
\end{algorithm}
